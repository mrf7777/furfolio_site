{% extends "furfolio/layouts/title_body.html" %}

{% block title %}
{{ offer.name }} by {% include "furfolio/users/badge.html" with user=offer.author show_avatar=True only %}
{% endblock %}

{% block body %}

    {% if offer.thumbnail %}
        <div class="d-flex justify-content-center mb-3">
            <img class="rounded border border-2 img-fluid" style="max-height: 40vh" src="{{ offer.thumbnail.url }}">
        </div>
    {% endif %}

    <p>
        <b>Slots: {{ offer.get_active_commissions.count }}</b> / <b>{{ offer.slots }}</b>
    </p>

    {{ offer.description|linebreaks }}

    {% if offer.forced_closed %}
        <p>
            <b>Forced closed</b>
        </p>
    {% elif offer.is_closed %}
        <p>
            <b>Closed</b>
        </p>
    {% else %}
        <p>
            Closes in <b>{{ offer.cutoff_date|timeuntil }}</b> ({{ offer.cutoff_date }})
        </p>
    {% endif %}

    {% if request.user.pk == offer.author.pk %}
        <a class="btn btn-primary mb-3" href="{% url "update_offer" offer.pk %}">Edit</a>
    {% endif %}

    <div>
        {% if should_show_create_commission_button %}
            <a class="btn btn-primary" href="{% url "create_commission" offer.pk %}">Request Commission</a>
        {% elif offer.is_closed %}
            <b>This offer is not accepting commissions because it is closed.</b>
        {% elif offer.has_max_review_commissions %}
            <b>This offer is not accepting commissions right now because it has the maximum number of commissions in review. Please try again later.</b>
        {% else %}
            <b>This offer is not accepting commissions at this time.</b>
        {% endif %}
    </div>

{% endblock %}