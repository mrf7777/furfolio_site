{% comment "" %}
Includable card that shows commission information
Expects the following objects:
commission: the commission object to show
csrf_token: the csrf_token
request: the request object
{% endcomment %}

{% load static %}

<div class="card">
    <div class="card-header">
        <div class="card-title">
            <h6>
                {% include "furfolio/users/badge.html" with user=commission.commissioner only %} - <a class="text-decoration-none" href="{% url "commission_detail" commission.pk %}">{{ commission.offer.name }}</a>
            </h6>
        </div>
    </div>

    <div class="card-body">
        <div class="card-text">
            <p>
                {{ commission.initial_request_text }}
            </p>
        </div>
    </div>

    <div class="card-footer">
        <h6>Change State</h6>
        <div class="d-flex flex-wrap">
        {% if commission.state == "REVIEW" %}
            <div class="me-1 mb-1">{% include "furfolio/commissions/state_buttons/state_setters/accept.html" with commission=commission request=request csrf_token=csrf_token only %}</div>
            <div class="me-1 mb-1">{% include "furfolio/commissions/state_buttons/state_setters/close.html" with commission=commission request=request csrf_token=csrf_token only %}</div>
        {% endif %}

        {% if commission.state == "ACCEPTED" %}
            <div class="me-1 mb-1">{% include "furfolio/commissions/state_buttons/state_setters/in_progress.html" with commission=commission request=request csrf_token=csrf_token only %}</div>
            <div class="me-1 mb-1">{% include "furfolio/commissions/state_buttons/state_setters/review.html" with commission=commission request=request csrf_token=csrf_token only %}</div>
            <div class="me-1 mb-1">{% include "furfolio/commissions/state_buttons/state_setters/close.html" with commission=commission request=request csrf_token=csrf_token only %}</div>
        {% endif %}

        {% if commission.state == "IN_PROGRESS" %}
            <div class="me-1 mb-1">{% include "furfolio/commissions/state_buttons/state_setters/close.html" with commission=commission request=request csrf_token=csrf_token only %}</div>
            <div class="me-1 mb-1">{% include "furfolio/commissions/state_buttons/state_setters/accept.html" with commission=commission request=request csrf_token=csrf_token only %}</div>
        {% endif %}

        {% if commission.state == "CLOSED" %}
            <div class="me-1 mb-1">{% include "furfolio/commissions/state_buttons/state_setters/in_progress.html" with commission=commission request=request csrf_token=csrf_token only %}</div>
        {% endif %}
        </div>
    </div>

</div>