{% extends "furfolio/layouts/title_body.html" %}

{% load static %}
{% load query_replace %}

{% block title %}
{% endblock %}

{% block title_class %}
{% endblock %}

{% block content_container_class %}container-fluid{% endblock %}

{% block body %}
<div class="d-flex">
    <div class="dropdown me-3">
        <button class="btn btn-primary dropdown-toggle fw-bold" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            Offers
        </button>
        <ul class="dropdown-menu">
            {# TODO: extract offer search url to python context #}
            <li><a class="dropdown-item fw-bold" href="{% url "offer_list" %}?author={{ request.user.username }}&sort=created_date">View</a></li>
            <li><a class="dropdown-item d-inline-flex fw-bold"  href="{% url "create_offer" %}"><img class="me-2" src="{% static "symbols/plus-black.svg" %}" style="width: 1em;">Create</a></li>
        </ul>
    </div>

    <div class="dropdown">
        <button class="btn btn-primary dropdown-toggle fw-bold" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            Commissions
        </button>
        <ul class="dropdown-menu">
            <li><a class="dropdown-item fw-bold" href="{% url "commissions" %}">View</a></li>
        </ul>
    </div>
</div>

<hr>

<form method="get" id="offer-select-form">
    {{ offer_select_form }}
</form>

<div
    hx-get="{% url "dashboard_commissions_component" %}?{% query_replace request "next" request.get_full_path %}"
    hx-trigger="every 5s"
    hx-swap="morph:innerHTML"
>
    {% include "./commissions_component.html" %}
</div>

{% include "furfolio/scripts/submit_form_on_change.html" with form_id="offer-select-form" only %}
{% include "furfolio/scripts/refresh_page_on_history_navigation.html" %}

{% endblock %}

